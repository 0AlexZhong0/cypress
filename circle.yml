machine:
  node:
    version: 6.1.0

test:
  pre:
    - npm run build:
        parallel: true

  override:
    ## run 'test-unit-once' and 'test-integration-once'
    ## on the 1st container
    - if [ $CIRCLE_NODE_INDEX == 0 ]; then npm run test-unit-once; fi:
        parallel: true

    - if [ $CIRCLE_NODE_INDEX == 0 ]; then npm run test-integration-once; fi:
        parallel: true

    ## run 'test-e2e-once' on the 2nd container
    - if [ $CIRCLE_NODE_INDEX == 1 ]; then npm run test-e2e-once; fi:
        parallel: true

  #   - npm run test-cov
  #   - npm run codecov
  #   - npm run coveralls