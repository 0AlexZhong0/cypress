<!doctype html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <title>Cypress</title>

    <link rel="stylesheet" href="css/cypress.css">

    <script type="text/javascript" src="js/vendor.js"></script>
    <script type="text/javascript" src="js/app.js"></script>
  </head>
  <body>
    <!-- <div class="arrow-box"></div> -->
    <div id="main-region"></div>
    <div id="footer-region"></div>

    <script type="text/javascript">
      require("coffee-script/register")

      require("nw.gui").Window.get().evalNWBin(null, "lib/secret_sauce.bin")
      global.SecretSauce = window.SecretSauce

      var NwApp   = require("nw.gui").App
      var booter  = require("../../lib/cypress")
      var updater = booter.Updater(NwApp)
      var Log     = booter.Log
      var Chromium = booter.Chromium
      var cache   = booter.cache

      cache.ensureExists().then(function(){
        var opts = {
          argv:    NwApp.argv,
          Log:     Log,
          Chromium: Chromium,
          cache:   cache,
          updater: updater,
          booter:  booter
        }

        // force App.start to be async
        setTimeout(function(){
          App.start(opts);
        }, 0)
      })
    </script>
  </body>
</html>