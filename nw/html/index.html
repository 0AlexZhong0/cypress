<!doctype html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <title>Cypress</title>

    <link rel="stylesheet" href="css/cypress.css">

    <script type="text/javascript" src="js/vendor.js"></script>
    <script type="text/javascript" src="js/app.js"></script>
  </head>
  <body>
    <!-- <div class="arrow-box"></div> -->
    <div id="main-region"></div>
    <div id="footer-region"></div>

    <script type="text/javascript">
      require("coffee-script/register")

      require("nw.gui").Window.get().evalNWBin(null, "lib/secret_sauce.bin")
      global.SecretSauce = window.SecretSauce

      Error.stackTraceLimit = Infinity

      var NwApp   = require("nw.gui").App
      var cypress = require("../../lib/cypress")
      var backend = cypress.Backend(NwApp)

      backend.cache.ensureExists().then(function(){
        var opts = {
          argv:    NwApp.argv,
          backend: backend
        }

        // force App.start to be async
        setTimeout(function(){
          App.start(opts);
        }, 0)
      })
    </script>
  </body>
</html>